webpackJsonp([7],{"44Gs":function(t,e){},dgbF:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=i("mvHQ"),s=i.n(a),n=(i("34+y"),i("X+yh")),o=i.n(n),r=i("//Fk"),l=i.n(r),d=i("mw3O"),c=i.n(d),m=i("FWuv"),u=i.n(m),v=(i("E84t"),i("mzkE")),h=i("za2D"),_=i("Eg0l"),f={components:{"foot-nav":v.a,"my-tab-container":h.a,share:_.a},data:function(){return{user_id:0,userInfo:{},loadBotVisible:!1,loadPageVisible:!0,swipeable:!0,kind:"",menuVisible:!1,active:"tab-container1",activeIndex:1,align:"left",maxHeight:"",maxWidth:"",maxDistance:0,scrollHeight:0,tabstate:[0,0,0],data:{tab1:{page:1,records:0,total:0,more:!0,items:[]},tab2:{page:1,records:0,total:0,more:!0,items:[]}}}},methods:{getUserInfo:function(){var t=this;this.$http.get(SYS.URL.moments.user+"&user_id="+this.user_id).then(function(e){var i=e.data;200===i.status&&(t.userInfo=i.data),t.loadPageVisible=!1})},tabIndex:function(t){var e;return"tab-container1"===t&&(e=0),"tab-container2"===t&&(e=1),"tab-container3"===t&&(e=2),e},tabId:function(){return"tab"+(this.activeIndex+1)},renderTab:function(t){var e=this;this.active=t,this.activeIndex=this.tabIndex(t),this.tabstate[this.activeIndex]||(this.getKind(),this.loadMoments(this.kind).then(function(){return e.masonry()})),this.tabstate[this.activeIndex]=1},getKind:function(){var t="";this.activeIndex,1===this.activeIndex&&(t="collect"),this.kind=t},loadTab:function(){var t=this;this.loadMoments(this.kind).then(function(){return t.masonry()})},loadTop:function(){var t=this,e=this.tabId(),i={kind:this.kind,last_time:this.data[e].items[0].moments_time,keyword:this.keyword,user_id:this.user_id};new l.a(function(a,s){t.$http.get(SYS.URL.moments.lists,{params:i}).then(function(i){var s=i.data;if(t.$refs.loadmore.onTopLoaded(),200===s.status)if(s.data.total>0){t.dealData(s.data);var n=t.fixItems(s.data.items);t.data[e].items=n.concat(t.data[e].items)}else o()({message:"没有最新的动态了哦~",position:"top",duration:2e3});a(i)})}).then(function(){return t.masonry()})},loadMore:function(){this.loading=!0,this.loadBotVisible=!0,this.loadTab()},loadMoments:function(t){var e=this,i=this.tabId(),a={kind:t,page:this.data[i].page,keyword:this.keyword,user_id:this.user_id};return new l.a(function(t,s){e.data[i].more?e.$http.get(SYS.URL.moments.lists,{params:a}).then(function(i){var a=i.data;if(200===a.status){var s=e.tabId();e.dealData(a.data);var n=e.fixItems(a.data.items);e.data[s].items.push.apply(e.data[s].items,n)}e.loadBotVisible=!1,t(i)}):e.loadBotVisible=!1})},doLike:function(t,e){var i=this,a=c.a.stringify({moments_id:t});this.$http.post(SYS.URL.moments.like_add,a).then(function(t){var a=t.data;if(200===a.status){var s=i.tabId();i.data[s].items[e].is_like=a.data.like_id,i.data[s].items[e].moments_like_count++}})},rmLike:function(t,e){var i=this,a=c.a.stringify({like_id:t});this.$http.post(SYS.URL.moments.like_remove,a).then(function(t){if(200===t.data.status){var a=i.tabId();i.data[a].items[e].is_like=0,i.data[a].items[e].moments_like_count--}})},doFollow:function(t){var e=this,i={};return i.up_user_id=t,new l.a(function(t,a){e.$http.post(SYS.URL.moments.follow_add,c.a.stringify(i)).then(function(i){var a=i.data;if(200===a.status){e.tabId();e.userInfo.is_follow=a.data.follow_id}t(i)})})},rmFollow:function(t){var e=this,i=c.a.stringify({follow_id:t});return new l.a(function(t,a){e.$http.post(SYS.URL.moments.follow_remove,i).then(function(i){if(200===i.data.status){e.tabId();e.userInfo.is_follow=0}t(i)})})},dealData:function(t){var e=this.tabId();this.data[e].page=t.page+1,this.data[e].records=t.records,this.data[e].total=t.total,this.data[e].loaded=!0,t.total!=t.page&&0!=t.total||(this.data[e].more=!1)},fixItems:function(t){var e=this;return t.forEach(function(i,a){var s=e.maxWidth,n=i.image_heigth/i.image_width*e.maxWidth;n=Math.min(n,e.maxHeight),t[a].image_width=s,t[a].image_heigth=n,t[a].shown=!1,t[a].animate=!1}),t},masonry:function(){var t=this;return new l.a(function(e,i){if(document.querySelector("#waterfull"+t.activeIndex)){new u.a("#waterfull"+t.activeIndex,{itemSelector:".moments-item",transitionDuration:0,resize:!1});var a=t.tabId();t.data[a].items.forEach(function(e,i){t.data[a].items[i].shown=!0,t.data[a].items[i].animate=!0})}t.load=!0,e(t)})},goBack:function(){if(window.history.length<=1)return this.$router.push({path:"/"}),!1;this.$router.go(-1)},startMove:function(){this.maxDistance=.001},endMove:function(){this.maxDistance=0},share:function(){},jumpVideoPlay:function(t){if(isApp){if("android"===isApp&&android.jumpVideoPlay(t,this.getKind()),"ios"===isApp){var e={moments_id:t,kind:this.getKind()},i=s()(e);window.webkit.messageHandlers.jumpVideoPlay.postMessage(i)}}else this.$router.push({path:"/detail/"+t})}},mounted:function(){this.getUserInfo();this.maxWidth=document.documentElement.clientWidth/2,this.maxHeight=Math.ceil(1.33*this.maxWidth),this.keyword=this.$route.params.keyword,this.active=this.$route.params.tab?this.$route.params.tab:"tab-container1",this.renderTab(this.active);var t=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight||0,e=document.querySelector(".header").offsetHeight,i=document.querySelector(".user").offsetHeight,a=document.querySelector(".nav-bar").offsetHeight,s=document.querySelector(".footnav").offsetHeight;this.scrollHeight=t-e-i-a-s,this.$nextTick(function(){console.log(document.querySelector(".pswp__caption__center--opt"))})},watch:{active:{handler:function(t){this.renderTab(t),this.maxDistance=0},deep:!0}},created:function(){this.user_id=this.$route.params.user_id}},p={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"page"},[a("div",{staticClass:"header header-bd"},[a("div",{staticClass:"header-back",on:{click:t.goBack}}),t._v(" "),a("h3",{staticClass:"header-title",staticStyle:{height:"2rem"}},[t._v(t._s(t.userInfo.user_nickname))]),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:t.isApp,expression:"isApp"}],staticClass:"header-share",on:{click:t.share}})]),t._v(" "),a("div",{staticClass:"user"},[a("div",{staticClass:"user-card"},[a("div",{staticClass:"user-img"},[a("a",{attrs:{href:"javascript:;"}},[a("img",{attrs:{src:t.userInfo.user_avatar,alt:t.userInfo.user_nickname,preview:"0"}})])]),t._v(" "),a("div",{staticClass:"user-info"},[a("div",{staticClass:"info-wrapper"},[a("div",{staticClass:"follow"},[a("router-link",{attrs:{to:{path:"/follow/"+this.user_id}}},[a("div",[t._v(t._s(t.userInfo.follow_count))]),t._v(" "),a("div",{staticStyle:{"font-size":".5rem"}},[t._v("关注")])])],1),t._v(" "),a("div",{staticClass:"fans"},[a("router-link",{attrs:{to:{path:"/fans/"+this.user_id}}},[a("div",[t._v(t._s(t.userInfo.fan_count))]),t._v(" "),a("div",{staticStyle:{"font-size":".5rem"}},[t._v("粉丝")])])],1),t._v(" "),a("div",{staticClass:"likes"},[a("div",[t._v(t._s(t.userInfo.like_count+t.userInfo.collect_count))]),t._v(" "),a("div",{staticStyle:{"font-size":".5rem"}},[t._v("获赞与收藏")])])]),t._v(" "),a("div",{staticClass:"edit-information"},[t.userInfo.is_follow?a("div",{staticClass:"edit followed",on:{click:function(e){return t.rmFollow(t.userInfo.is_follow)}}},[t._v("\n                        已关注\n                    ")]):a("div",{staticClass:"edit follow",on:{click:function(e){return t.doFollow(t.userInfo.user_id)}}},[t._v("\n                        关注\n                    ")])])])])]),t._v(" "),a("div",{staticClass:"nav-bar"},[a("div",{staticClass:"nav-inner"},[a("div",{staticClass:"nav-inner-item",class:"tab-container1"==t.active?"selected":"",on:{click:function(e){return t.renderTab("tab-container1")}}},[a("span",[t._v("动态")])]),t._v(" "),a("div",{staticClass:"nav-inner-item",class:"tab-container2"==t.active?"selected":"",on:{click:function(e){return t.renderTab("tab-container2")}}},[a("span",[t._v("收藏")])])])]),t._v(" "),a("div",{staticClass:"tab-container"},[a("mt-loadmore",{ref:"loadmore",attrs:{"top-method":t.loadTop,maxDistance:t.maxDistance}},[a("div",{staticClass:"mint-spinner-top",attrs:{slot:"top"},slot:"top"},[a("mt-spinner",{attrs:{type:"fading-circle"}})],1),t._v(" "),a("my-tab-container",{staticClass:"page-tabbar-tab-container",attrs:{swipeable:t.swipeable},on:{"end-move":t.endMove,"start-move":t.startMove},model:{value:t.active,callback:function(e){t.active=e},expression:"active"}},[a("mt-tab-container-item",{attrs:{id:"tab-container1"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:t.data.tab1.loaded,expression:"data.tab1.loaded"},{name:"infinite-scroll",rawName:"v-infinite-scroll",value:t.loadMore,expression:"loadMore"}],ref:"wrapper1",staticClass:"moments-scroll",style:{height:t.scrollHeight+"px"},attrs:{"infinite-scroll-disabled":"loading","infinite-scroll-distance":"10","infinite-scroll-immediate-check":"check"}},[t.data.tab1.items.length>0?a("div",{staticClass:"moments-list effect-1",attrs:{id:"waterfull0"}},[t._l(t.data.tab1.items,function(e,i){return a("div",{staticClass:"moments-item",class:e.shown?"shown animate":"",attrs:{index:e.index}},[a("div",{staticClass:"moments-wrap"},[a("div",{staticClass:"moments-media",style:{height:e.image_heigth+"px",maxHeight:t.maxHeight+"px"}},[1==e.moments_type?a("router-link",{attrs:{to:1==e.moments_status?"/detail/"+e.moments_id:"/edit/"+e.moments_id}},[a("img",{directives:[{name:"lazy",rawName:"v-lazy",value:e.moments_image[0],expression:"item.moments_image[0]"}],staticStyle:{width:"100%",display:"block"}})]):4==e.moments_type?[a("img",{directives:[{name:"lazy",rawName:"v-lazy",value:e.moments_image[0],expression:"item.moments_image[0]"}],staticStyle:{width:"100%",display:"block"},on:{click:function(i){return t.jumpVideoPlay(e.moments_id)}}}),t._v(" "),a("i",{staticClass:"icon icon-video"})]:t._e()],2),t._v(" "),a("div",{staticClass:"moments-content"},[1==e.moments_type?a("router-link",{staticStyle:{display:"block"},attrs:{to:"/detail/"+e.moments_id}},[a("p",{domProps:{innerHTML:t._s(e.moments_title.toString())}})]):a("p",{domProps:{innerHTML:t._s(e.moments_title.toString())},on:{click:function(i){return t.jumpVideoPlay(e.moments_id)}}})],1),t._v(" "),a("div",{staticClass:"moments-info"},[a("div",{staticClass:"moments-uper"},[a("div",{staticClass:"uper-avatar"},[a("img",{staticStyle:{display:"block"},attrs:{alt:e.user_avatar,src:e.user_avatar}})]),t._v(" "),a("div",{staticClass:"uper-nickname"},[t._v("\n                                                "+t._s(e.user_nickname)+"\n                                            ")])]),t._v(" "),a("div",{staticClass:"moments-collect"},[e.is_like?a("i",{staticClass:"icon icon-liked",on:{click:function(a){return t.rmLike(e.is_like,i)}}}):a("i",{staticClass:"icon icon-like",on:{click:function(a){return t.doLike(e.moments_id,i)}}}),t._v(" "),a("span",[t._v(t._s(e.moments_like_count))])])])])])})],2):a("div",{staticClass:"no-record"},[a("div",{staticClass:"no-record-content"},[a("div",{staticClass:"no-record-bg"},[a("img",{staticStyle:{width:"60px"},attrs:{src:i("62zQ")}})]),t._v(" "),a("p",[t._v("TA还没有发布的动态哦~")])])])])]),t._v(" "),a("mt-tab-container-item",{attrs:{id:"tab-container2"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:t.data.tab2.loaded,expression:"data.tab2.loaded"},{name:"infinite-scroll",rawName:"v-infinite-scroll",value:t.loadMore,expression:"loadMore"}],ref:"wrapper2",staticClass:"moments-scroll",style:{height:t.scrollHeight+"px"},attrs:{"infinite-scroll-disabled":"loading","infinite-scroll-distance":"10","infinite-scroll-immediate-check":"check"}},[t.data.tab2.items.length>0?a("div",{staticClass:"moments-list effect-1",attrs:{id:"waterfull1"}},[t._l(t.data.tab2.items,function(e,i){return a("div",{staticClass:"moments-item",class:{shown:e.shown,animate:e.animate},attrs:{index:e.index}},[a("div",{staticClass:"moments-wrap"},[a("div",{staticClass:"moments-media",style:{height:e.image_heigth+"px",maxHeight:t.maxHeight+"px"}},[1==e.moments_type?a("router-link",{attrs:{to:1==e.moments_status?"/detail/"+e.moments_id:"/edit/"+e.moments_id}},[a("img",{directives:[{name:"lazy",rawName:"v-lazy",value:e.moments_image[0],expression:"item.moments_image[0]"}],staticStyle:{width:"100%",display:"block"}})]):4==e.moments_type?[a("img",{directives:[{name:"lazy",rawName:"v-lazy",value:e.moments_image[0],expression:"item.moments_image[0]"}],staticStyle:{width:"100%",display:"block"},on:{click:function(i){return t.jumpVideoPlay(e.moments_id)}}}),t._v(" "),a("i",{staticClass:"icon icon-video"})]:t._e()],2),t._v(" "),a("div",{staticClass:"moments-content"},[1==e.moments_type?a("router-link",{staticStyle:{display:"block"},attrs:{to:"/detail/"+e.moments_id}},[a("p",{domProps:{innerHTML:t._s(e.moments_title.toString())}})]):a("p",{domProps:{innerHTML:t._s(e.moments_title.toString())},on:{click:function(i){return t.jumpVideoPlay(e.moments_id)}}})],1),t._v(" "),a("div",{staticClass:"moments-info"},[a("div",{staticClass:"moments-uper"},[a("div",{staticClass:"uper-avatar"},[a("img",{staticStyle:{display:"block"},attrs:{alt:e.user_avatar,src:e.user_avatar}})]),t._v(" "),a("div",{staticClass:"uper-nickname"},[t._v("\n                                                  "+t._s(e.user_nickname)+"\n                                              ")])]),t._v(" "),a("div",{staticClass:"moments-collect"},[e.is_like?a("i",{staticClass:"icon icon-liked",on:{click:function(a){return t.rmLike(e.is_like,i)}}}):a("i",{staticClass:"icon icon-like",on:{click:function(a){return t.doLike(e.moments_id,i)}}}),t._v(" "),a("span",[t._v(t._s(e.moments_like_count))])])])])])})],2):a("div",{staticClass:"no-record"},[a("div",{staticClass:"no-record-content"},[a("div",{staticClass:"no-record-bg"},[a("img",{staticStyle:{width:"60px"},attrs:{src:i("62zQ")}})]),t._v(" "),a("p",[t._v("TA还没有收藏的动态哦~")])])])])])],1),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:t.loadBotVisible,expression:"loadBotVisible"}],staticClass:"mint-spinner-bottom"},[a("mt-spinner",{attrs:{type:"fading-circle"}})],1)],1)],1),t._v(" "),a("foot-nav"),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:t.loadPageVisible,expression:"loadPageVisible"}],staticClass:"page-load"},[a("mt-spinner",{attrs:{type:"fading-circle"}})],1)],1)},staticRenderFns:[]};var g=i("VU/8")(f,p,!1,function(t){i("44Gs")},"data-v-f99e4ecc",null);e.default=g.exports}});